<!DOCTYPE html>
{% load static %}
{% load filter_pag_order %}
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Django Modal Form Ajax Submit</title>
    <link rel="shortcut icon" type="image/png" href="{% static 'app_d/images/favicon.png' %}" />
    <link rel="stylesheet" href="{% static 'app_d/css/general.css' %}">
    <link rel="stylesheet" href="{% static 'app_d/css/header.css' %}">
    <link rel="stylesheet" href="{% static 'app_d/css/lefter.css' %}">
    <link rel="stylesheet" href="{% static 'app_d/css/main.css' %}">
    <link rel="stylesheet" href="{% static 'app_d/css/modals.css' %}">


    <link rel="stylesheet" href="{% static 'common/fontawesome-free-6.1.1-web/css/all.css' %}">
</head>

<body>
    <!-- header -->
    <div class="header">
        <div class="header-left">
            <div class="main-title">CMSLite</div>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-align-center status_toggle middle" id="sidebar-toggle" onclick="toggleLefter();">
                <line x1="18" y1="10" x2="6" y2="10"></line>
                <line x1="21" y1="6" x2="3" y2="6"></line>
                <line x1="21" y1="14" x2="3" y2="14"></line>
                <line x1="18" y1="18" x2="6" y2="18"></line>
            </svg>
        </div>
        <div class="header-middle">
            <div>
                <div id="plus">
                </div>
            </div>
        </div>
        <div class="header-right">
            <div class="notification-box">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="feather feather-bell">
                    <path d="M22 17H2a3 3 0 0 0 3-3V9a7 7 0 0 1 14 0v5a3 3 0 0 0 3 3zm-8.27 4a2 2 0 0 1-3.46 0"></path>
                </svg>
            </div>
            <div class="logout">
                <a href="/" data-bs-original-title="" title="">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="feather feather-log-out">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                        <polyline points="16 17 21 12 16 7"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                    <span>Logout</span>
                </a>
            </div>
            <div class="profile">
                <img src="{% static 'app_d/images/default_profile.jpg' %}" alt="">
            </div>
        </div>
    </div>
    <!-- lefter -->
    <div class="lefter">
        <ul>
            <li>Alpha</li>
            <li>Beta</li>
            <li>Gamma</li>
            <li>Delta</li>
            <li>Epsilon</li>
            <li>Zeta</li>
            <li>Eta</li>
            <li>Theta</li>
            <li>Iota</li>
            <li>Kappa</li>
        </ul>
    </div>
    <!-- main -->
    <div class="main">
        <form novalidate id="search_form">
        <div class="search">
            {% for field in search_form %}
            <div class="form-field">
                {{ field.label_tag }}
                <div class="field">
                    {{ field }}
                </div>
            </div>
            {% endfor %}
            <div class="form-field">
                    <a class="reset-button" href="{% url 'app_d:list' %}">Reset</a>
                    <button class="search-button">Search</button>
            </div>
        </div>
        </form>
        <div class="actions">
            <button class="green" id="create-button">Create</button>
            <button class="orange disabled" id="update-button" disabled>Update</button>
            <button class="red disabled" id="delete-button" disabled>Delete</button>
            <button class="yellow">Yellow</button>
            <button class="green"><a href="#">Green</a></button>
        </div>
        <div class="table-container">
            <table>
                <thead>
                    <th class="id-row"><input type="checkbox" id="toggle-checkboxes"></th>
                    <th>Shorter Characters</th>
                    <th class="title">Boolean</th>
                    <th style="display: flex; 
                    justify-content: space-between; 
                    align-items: center;">
                    <a style="text-decoration: none;" href="{% relative_url '-date' 'order_by' request.GET.urlencode %}">ðŸ”½</a>
                    <span>Date</span>
                    <a style="text-decoration: none;" href="{% relative_url 'date' 'order_by' request.GET.urlencode %}">ðŸ”¼</a>
                    </th>
                    <th>Longer Characters</th>
                    <th>Date & Time</th>
                    <th style="display: flex; 
                    justify-content: space-between; 
                    align-items: center;">
                    <a style="text-decoration: none;" href="{% relative_url '-integer' 'order_by' request.GET.urlencode %}">ðŸ”½</a>
                    <span>Integer</span>
                    <a style="text-decoration: none;" href="{% relative_url 'integer' 'order_by' request.GET.urlencode %}">ðŸ”¼</a>
                    </th>
                    <th>Float</th>
                    <th>Decimal Number</th>
                    <th>Text</th>
                </thead>
                <tbody>
                    {% for s in samplemodel_list %}
                    <tr id="{{ s.pk }}">
                        <td class="id-row"><input type="checkbox" value="{{ s.pk }}" name="ids"></td>
                        <td class="title">{{ s.char }}</td>
                        <td>{{ s.bool }}</td>
                        <td>{{ s.date|date:"Y-m-d" }}</td>
                        <td class="long">{{ s.longer_char }}</td>
                        <td>{{ s.datetime|date:"Y-m-d H:i:s" }}</td>
                        <td>{{ s.integer }}</td>
                        <td>{{ s.float_info }}</td>
                        <td>{{ s.decimal }}</td>
                        <!-- <td>{{ s.text|truncatewords:3 }}</td> -->
                        <!-- truncatewords åªèƒ½ç”¨äºŽå¤–æ–‡å•è¯ -->
                        <td>{{ s.text|truncatewords:3 }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="pagination">
            <div>Total {{ page_obj.paginator.count }} records in {{page_obj.paginator.num_pages}} pages</div>
            <ul>
                {% if page_obj.has_previous %}
                    <a class="page-link {% if i == page_obj.previous_page_number %}active{% endif %}" href="{% relative_url page_obj.previous_page_number 'page' request.GET.urlencode %}">prev</a>
                {% endif %}

                {% for i in page_obj.paginator.page_range %}
                    {% if i == 1 %}
                        <a class="page-link {% if i == page_obj.number %}active{% endif %}" href="{% relative_url i 'page' request.GET.urlencode %}">|&lt;</a>
                    {% elif i == page_obj.paginator.num_pages %}
                        <a class="page-link {% if i == page_obj.number %}active{% endif %}" href="{% relative_url i 'page' request.GET.urlencode %}">&gt;|</a>
                    {% else %}
                        <a class="page-link {% if i == page_obj.number %}active{% endif %}" href="{% relative_url i 'page' request.GET.urlencode %}">{{ i }}</a>
                    {% endif %}
                {% endfor %}

                {% if page_obj.has_next %}
                    <a class="page-link {% if i == page_obj.next_page_number %}active{% endif %}" href="{% relative_url page_obj.next_page_number 'page' request.GET.urlencode %}">next</a>
                {% endif %}

                <input type="text" step="1" min="1" max="{{ page_obj.paginator.num_pages }}" id="page-input">
                <a class="page-link active" href="javascript:goPage()">GO</a>
            </ul>
        </div>
    </div>
    <!-- modals-->
    <div class="overlay delete-overlay">
        <div class="delete-modal">
            <h1>Confirm Delete</h1>
            <p>Are you sure to delete?</p>
            <div class="button-group">
                <button class="cancel-button">Cancel</button>
                <button class="confirm-button" id="js-delete-confirm">Confirm</button>
            </div>
        </div>
    </div>

    <div class="overlay create-overlay">
        <div class="create-modal">
            <h1>Create New</h1>
            <form id="create-update-form" novalidate>
                {% csrf_token %}
                <div class="form">
                    <input type="hidden" name="post_ids" value="">
                    {% for field in form %}
                    <div class="form-field">
                        {{ field.label_tag }}
                        <div class="field">
                            {{ field }}
                            <div class="field-error" id="{{ field.name}}_error">&nbsp;</div>
                        </div>
                    </div>
                    {% endfor %}

                </div>
                <div class="button-group">
                    <button class="cancel-button" type="button" id="cancel-create-button">Cancel</button>
                    <button class="submit-button green" type="submit">Submit</button>
                </div>
            </form>
        </div>
    </div>
    <script src="{% static 'app_d/js/jquery-3.6.0.min.js' %}"></script>
    <script src="{% static 'app_d/js/ajax.js' %}"></script>
    <script src="{% static 'app_d/js/modals.js' %}"></script>
    <script src="{% static 'app_d/js/main.js' %}"></script>
    <script>
        var search_str = window.location.search.substring(1)
        var str_list = search_str.split("&");
        for (let i = 0; i < str_list.length; i++) {
            const pair = str_list[i].split("=")
            const [name, value] = pair

            // for checkboxes
            if (name.endsWith("__in")) {
                for (let j = 0; j < pair.length; j++) {
                    if (value) {
                        $(`input[name=${name}][value=${value}]`).prop("checked", true)
                    }
                }
            } 
            // for input fields
            else {
                // let sel = $("select[name=" + str1[0] + "]");
                // let sel = $(`select[name='${str1[0]}']`);
                // sel.val(decodeURIComponent(str1[1]));
                 $(`input[name=${name}]`).val(decodeURIComponent(value));
                // $(`input[name=${name}]`).val(value);
            }
        }

        function goPage() {
            let page = $("#page-input").val();
            max = '{{ page_obj.paginator.num_pages }}';
            if (Number.isInteger(Number(page)) && Number(page) <= Number(max)) {
                location.href = `{% relative_url '${page}' 'page' request.GET.urlencode %}`.replaceAll('&amp;', '&');
            }
        }
    </script>
</body>

</html>